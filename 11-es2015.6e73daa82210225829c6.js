(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{K7XH:function(e,t,n){"use strict";n.r(t),n.d(t,"MessagesModule",(function(){return S}));var o=n("ofXK"),s=n("lDzL"),i=n("YpNe"),c=n("tyNb"),r=n("fXoL"),a=n("Eh0y"),l=n("SvO3"),g=n("3Pt+"),d=n("pqks"),b=n("668k"),p=n("sYmb");const h=["scrollMe"];function u(e,t){if(1&e&&(r.Yb(0,"div",23),r.Tb(1,"app-loader",24),r.Xb()),2&e){const e=r.oc();r.Cb(1),r.tc("loading",e.loading)}}function m(e,t){if(1&e&&(r.Yb(0,"span",32),r.Yb(1,"a",33),r.Tb(2,"app-feather-icons",34),r.Xb(),r.Tb(3,"img",35),r.Tb(4,"br"),r.Xb()),2&e){const e=t.$implicit;r.Cb(1),r.tc("href",e,r.Jc),r.Cb(1),r.tc("icon","download"),r.Cb(1),r.tc("src",e||"assets/images/product-list/001.jpg",r.Jc)}}function f(e,t){if(1&e&&(r.Yb(0,"span",30),r.Pc(1,m,5,3,"span",31),r.Xb()),2&e){const e=r.oc(2).$implicit;r.Cb(1),r.tc("ngForOf",e.images)}}function C(e,t){if(1&e&&(r.Yb(0,"span",28),r.Yb(1,"span"),r.Rc(2),r.Xb(),r.Pc(3,f,2,1,"span",29),r.Xb()),2&e){const e=r.oc().$implicit,t=r.oc();r.Oc("display",t.msgContainerStyle(e)),r.Cb(2),r.Sc(e.text),r.Cb(1),r.tc("ngIf",e.images&&e.images.length)}}const M=function(e,t){return{right:e,left:t}};function v(e,t){if(1&e&&(r.Yb(0,"li",25),r.Yb(1,"div",26),r.Pc(2,C,4,4,"span",27),r.Xb(),r.Xb()),2&e){const e=t.$implicit,n=r.oc();r.tc("ngClass",r.yc(4,M,e.receiverId===n.user.senderId,e.receiverId!==n.user.senderId)),r.Cb(1),r.Oc("text-align",e.receiverId===n.user.senderId?"-webkit-right":"-webkit-left"),r.Cb(1),r.tc("ngIf",e.text||e.images.length)}}function P(e,t){if(1&e){const e=r.Zb();r.Yb(0,"div",36),r.Yb(1,"span",37),r.Yb(2,"app-feather-icons",38),r.kc("click",(function(){return r.Hc(e),r.oc().showDropzone(!1)})),r.Xb(),r.Xb(),r.Yb(3,"div",39),r.Yb(4,"div",40),r.Yb(5,"dropzone",41),r.kc("error",(function(t){return r.Hc(e),r.oc().onUploadError(t)}))("addedFile",(function(t){return r.Hc(e),r.oc().fileAdded(t)}))("removedFile",(function(t){return r.Hc(e),r.oc().removeFile(t)})),r.Xb(),r.Xb(),r.Xb(),r.Xb()}if(2&e){const e=r.oc();r.Cb(2),r.tc("icon","x-circle"),r.Cb(3),r.tc("config",e.config)("message","Click or drag images here to upload")}}const O=function(e){return{online:e}};let x=(()=>{class e{constructor(){this.scrolltop=240,this.user={},this.loading=!1,this.messages=[],this.onlineUsers=[],this.sendMsg=new r.n,this.msg="",this.files=[],this.enableAttachment=!1,this.isSending=!1,this.config={clickable:!0,maxFiles:4,acceptedFiles:"image/*",maxFilesize:10,autoReset:null,errorReset:null,cancelReset:null,autoProcessQueue:!1,autoQueue:!1,addRemoveLinks:!0,createImageThumbnails:!0}}ngOnInit(){}sendMessage(){if(this.msg.trim()||this.files.length){let e={msg:this.msg};this.isSending=!0,this.files.length&&(e.images=this.files.map(e=>this.removeBase64(e.dataURL))),this.sendMsg.emit(e)}}removeBase64(e){return e.split("base64,")[1]}resetState(){this.msg="",this.enableAttachment=!1,this.files=[]}userStatus(e){return!(!this.onlineUsers.length||!this.onlineUsers.includes(e))}get onScroll(){if(this.scrollMe&&this.scrollMe.nativeElement){let e=this.scrollMe.nativeElement;e.scrollHeight!==this.scrolltop&&setTimeout(()=>{this.scrolltop=e.scrollHeight},500)}return this.scrolltop}showDropzone(e){this.enableAttachment=e}onUploadInit(e){console.log("dropzone Init",e)}onUploadError(e){console.log("\u{1f4bb}","on dropzone error",e)}onUploadSuccess(e){console.log("\u{1f4bb}","on dropzone success",e)}fileAdded(e){console.log("\u{1f4bb}","on dropzone file added",e),this.files.push(e)}removeFile(e){console.log("\u{1f4bb}","on dropzone remove",e);let t=this.files.findIndex(t=>t.upload.uuid===e.upload.uuid);this.files.splice(t,1)}downloadImage(e){console.log(e)}msgContainerStyle(e){return!e.text&&e.images&&e.images.length||e.text&&e.images&&e.images.length?"table-cell":e.text&&e.text.length<60?"unset":"inline-block"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Mb({type:e,selectors:[["app-chat-box"]],viewQuery:function(e,t){var n;1&e&&r.Xc(h,!0),2&e&&r.Cc(n=r.lc())&&(t.scrollMe=n.first)},inputs:{user:"user",loading:"loading",messages:"messages",onlineUsers:"onlineUsers"},outputs:{sendMsg:"sendMsg"},decls:32,vars:18,consts:[[2,"height","100%","min-height","300px"],[1,"row",2,"height","100%"],[1,"col-sm-12"],[1,"card","chat-container"],[1,"card-header"],[1,"list"],[1,"clearfix"],["alt","",1,"rounded-circle","user-image","blur-up","lazyloaded",3,"src"],[1,"status-circle","offline",3,"ngClass"],[1,"about"],[1,"name"],[1,"status"],[1,"card-body","content",3,"scrollTop"],["scrollMe",""],["style","display: flex; align-items: center; justify-content: center",4,"ngIf"],["class","msg-list",3,"ngClass",4,"ngFor","ngForOf"],[1,"action-footer"],["class","attachment-container",4,"ngIf"],[1,"needs-validation",3,"submit"],[2,"display","grid","grid-template-columns","1fr 9fr 1fr","margin-top","5px"],[1,"icon-btn"],[1,"font-primary",2,"color","#fff !important",3,"icon","click"],["type","text","name","msg",3,"ngModel","placeholder","ngModelChange"],[2,"display","flex","align-items","center","justify-content","center"],[3,"loading"],[1,"msg-list",3,"ngClass"],[1,"msg-container"],["class","msg",3,"display",4,"ngIf"],[1,"msg"],["class","img-list",4,"ngIf"],[1,"img-list"],["class","img-container",4,"ngFor","ngForOf"],[1,"img-container"],["download","","target","_blank",1,"download-icon",2,"position","absolute","right","0",3,"href"],[1,"font-primary",3,"icon"],["alt","chat-image",1,"img-fluid","img-90","rounded","blur-up","lazyloaded",3,"src"],[1,"attachment-container"],[1,"close-btn"],[1,"font-primary",3,"icon","click"],[1,"row"],[1,"col-12"],[3,"config","message","error","addedFile","removedFile"]],template:function(e,t){1&e&&(r.Yb(0,"div",0),r.Yb(1,"div",1),r.Yb(2,"div",2),r.Yb(3,"div",3),r.Yb(4,"div",4),r.Yb(5,"ul",5),r.Yb(6,"li",6),r.Tb(7,"img",7),r.Tb(8,"div",8),r.Yb(9,"div",9),r.Yb(10,"div",10),r.Rc(11),r.Xb(),r.Yb(12,"div",11),r.Rc(13),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Yb(14,"div",12,13),r.Pc(16,u,2,1,"div",14),r.Yb(17,"ul"),r.Pc(18,v,3,7,"li",15),r.Xb(),r.Xb(),r.Yb(19,"div",16),r.Pc(20,P,6,3,"div",17),r.Yb(21,"form",18),r.kc("submit",(function(){return t.sendMessage()})),r.Yb(22,"div",19),r.Yb(23,"div",20),r.Yb(24,"span"),r.Yb(25,"app-feather-icons",21),r.kc("click",(function(){return t.showDropzone(!0)})),r.Xb(),r.Xb(),r.Xb(),r.Yb(26,"div"),r.Yb(27,"input",22),r.kc("ngModelChange",(function(e){return t.msg=e})),r.pc(28,"translate"),r.Xb(),r.Xb(),r.Yb(29,"div",20),r.Yb(30,"span"),r.Yb(31,"app-feather-icons",21),r.kc("click",(function(){return t.sendMessage()})),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb()),2&e&&(r.Cb(7),r.tc("src",t.user.imageUrl?t.user.imageUrl:"assets/images/team/1.jpg",r.Jc),r.Cb(1),r.tc("ngClass",r.xc(16,O,t.userStatus(t.user.senderId))),r.Cb(3),r.Sc(null==t.user?null:t.user.name),r.Cb(2),r.Sc(null==t.user?null:t.user.status),r.Cb(1),r.tc("scrollTop",t.onScroll),r.Cb(2),r.tc("ngIf",t.loading),r.Cb(2),r.tc("ngForOf",t.messages),r.Cb(2),r.tc("ngIf",t.enableAttachment),r.Cb(5),r.tc("icon","paperclip"),r.Cb(2),r.uc("placeholder",r.qc(28,14,"messeges_Typehere")),r.tc("ngModel",t.msg),r.Cb(4),r.Oc("pointer-events",t.isSending?"none":"auto"),r.tc("icon","send"))},directives:[o.k,o.m,o.l,g.y,g.n,g.o,d.a,g.b,g.m,g.p,b.a,i.b],pipes:[p.c],styles:['.chat-container[_ngcontent-%COMP%]{position:relative;height:100%}.chat-container[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:10px 30px;border-bottom:1px solid #c1c1c1}.chat-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{width:100%;max-height:100vh;overflow:auto;padding-bottom:10px}.chat-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:25px}.chat-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   li.right[_ngcontent-%COMP%]{text-align:right}.chat-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   li.right[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]{display:inline-block;background-color:#e1ffc7;color:#000;border-top-right-radius:0;position:relative}.chat-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   li.right[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]:after{top:0;right:-10px;position:absolute;content:"";width:0;height:0;border-color:transparent transparent transparent #e1ffc7;border-style:solid;border-width:0 0 10px 10px}.chat-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]{color:#898989;width:100%;background-color:#ddd;border:1px solid #f8f8f9;padding:10px 15px;border-radius:8px;letter-spacing:1px;position:relative}.chat-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   li.left[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]{border-top-left-radius:0;position:relative}.chat-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   li.left[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]:after{top:0;left:-10px;position:absolute;content:"";width:0;height:0;border-color:transparent #ddd transparent transparent;border-style:solid;border-width:0 10px 10px 0}.chat-container[_ngcontent-%COMP%]   .img-list[_ngcontent-%COMP%]   .img-container[_ngcontent-%COMP%]{display:block;position:relative;margin-bottom:5px;padding:10px}.chat-container[_ngcontent-%COMP%]   .img-list[_ngcontent-%COMP%]   .img-container[_ngcontent-%COMP%]   .download-icon[_ngcontent-%COMP%]{position:absolute;cursor:pointer;right:0;opacity:0;visibility:hidden}.chat-container[_ngcontent-%COMP%]   .img-list[_ngcontent-%COMP%]   .img-container[_ngcontent-%COMP%]:hover   .download-icon[_ngcontent-%COMP%]{visibility:visible;opacity:1;transition:all .4s ease-in-out}.action-footer[_ngcontent-%COMP%]{position:absolute;width:100%;bottom:0;background-color:#c1c1c1;height:45px}.action-footer[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:40px;width:100%;border:none;outline:transparent;padding-left:10px}.action-footer[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]{height:40px;background-color:#c1c1c1}.action-footer[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;cursor:pointer}.card-header[_ngcontent-%COMP%]   .user-image[_ngcontent-%COMP%]{float:left;width:52px;height:52px;margin-right:5px}.card-header[_ngcontent-%COMP%]   .about[_ngcontent-%COMP%]{float:left;margin-top:5px;padding-left:10px}.card-header[_ngcontent-%COMP%]   .friend-list[_ngcontent-%COMP%]{text-align:right}.offline[_ngcontent-%COMP%]{background-color:red}.online[_ngcontent-%COMP%]{background-color:#81ba00}  .attachment-container{background-color:#c1c1c1}  .attachment-container .close-btn{display:block;text-align:right;cursor:pointer}  .attachment-container .dz-progress{display:none!important}  .attachment-container .dz-preview{background-color:#c1c1c1!important}']}),e})();const _=["chatBox"];function y(e,t){1&e&&(r.Yb(0,"div",8),r.Rc(1," Click on user to start chat "),r.Xb())}function X(e,t){if(1&e){const e=r.Zb();r.Yb(0,"app-chat-box",9,10),r.kc("sendMsg",(function(t){return r.Hc(e),r.oc().sendMessage(t)})),r.Xb()}if(2&e){const e=r.oc();r.tc("user",e.selectedUser)("onlineUsers",e.signalRService.onlineUsers)("loading",e.loadingMessages)("messages",e.signalRService.messages)}}const Y=[{path:"",component:(()=>{class e{constructor(e){this.signalRService=e,this.selectedUser={},this.allUsers=[],this.messages=[],this.loadingMessages=!1,this.loadingUsers=!1,this.openChatScreen=!1,this.text="",this.receiver_id="",this.userId=""}ngOnInit(){this.getSellersList(),this.createConnection()}ngOnDestroy(){this.signalRService.disconnection("ChatHub")}createConnection(){this.signalRService.connect()}getSellersList(){this.loadingUsers=!0,this.signalRService.getChatList().subscribe(e=>{console.log("chat list",e),this.loadingUsers=!1,e&&e.body&&e.body.senderList&&(this.allUsers=e.body.senderList)})}openChat(e){this.openChatScreen=!0,console.log("user",e),this.selectedUser=e,this.getMessages(e.senderId)}sendMessage({msg:e,images:t}){this.signalRService.sendMessageToApi({text:e,receiverId:this.selectedUser.senderId,images:t}).subscribe(e=>{e&&this.chatBox.resetState()})}getMessages(e){this.loadingMessages=!0,this.signalRService.getChatMessage(e).subscribe(e=>{console.log("get component res get messages",e),this.loadingMessages=!1})}}return e.\u0275fac=function(t){return new(t||e)(r.Sb(a.a))},e.\u0275cmp=r.Mb({type:e,selectors:[["app-list-message"]],viewQuery:function(e,t){var n;1&e&&r.Xc(_,!0),2&e&&r.Cc(n=r.lc())&&(t.chatBox=n.first)},decls:8,vars:5,consts:[[1,"container-fluid"],[1,"row"],[1,"col-12","col-md-4",2,"margin-bottom","20px"],[1,"right-sidebar","chat-side-bar"],[3,"onlineUsers","allUsers","loading","selectUser"],[1,"col-12","col-md-8",2,"margin-bottom","20px"],["class","no-chat-msg",4,"ngIf"],[3,"user","onlineUsers","loading","messages","sendMsg",4,"ngIf"],[1,"no-chat-msg"],[3,"user","onlineUsers","loading","messages","sendMsg"],["chatBox",""]],template:function(e,t){1&e&&(r.Yb(0,"div",0),r.Yb(1,"div",1),r.Yb(2,"div",2),r.Yb(3,"div",3),r.Yb(4,"app-right-sidebar",4),r.kc("selectUser",(function(e){return t.openChat(e)})),r.Xb(),r.Xb(),r.Xb(),r.Yb(5,"div",5),r.Pc(6,y,2,0,"div",6),r.Pc(7,X,2,4,"app-chat-box",7),r.Xb(),r.Xb(),r.Xb()),2&e&&(r.Cb(4),r.tc("onlineUsers",t.signalRService.onlineUsers)("allUsers",t.allUsers)("loading",t.loadingUsers),r.Cb(2),r.tc("ngIf",!t.openChatScreen),r.Cb(1),r.tc("ngIf",t.openChatScreen))},directives:[l.a,o.m,x],styles:[".chat-side-bar[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;box-shadow:0 0 9px hsla(0,0%,74.9%,.36);right:0!important;top:0!important;position:unset!important}.no-chat-msg[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;color:#c1c1c1;font-size:16px}"]}),e})(),data:{title:"All Messages",breadcrumb:"Messages"}}];let w=(()=>{class e{}return e.\u0275mod=r.Qb({type:e}),e.\u0275inj=r.Pb({factory:function(t){return new(t||e)},imports:[[c.h.forChild(Y)],c.h]}),e})();var k=n("PCNd");const U={maxFilesize:50,url:"https://httpbin.org/post"};let S=(()=>{class e{}return e.\u0275mod=r.Qb({type:e}),e.\u0275inj=r.Pb({factory:function(t){return new(t||e)},providers:[{provide:i.a,useValue:U}],imports:[[o.c,w,s.f,k.a,i.d]]}),e})()}}]);
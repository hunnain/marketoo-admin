function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{K7XH:function(e,n,t){"use strict";t.r(n),t.d(n,"MessagesModule",(function(){return F}));var i=t("ofXK"),o=t("lDzL"),s=t("YpNe"),c=t("tyNb"),r=t("fXoL"),a=t("Eh0y"),l=t("SvO3"),g=t("3Pt+"),d=t("pqks"),u=t("668k"),b=t("sYmb"),h=["scrollMe"];function p(e,n){if(1&e&&(r.Yb(0,"div",23),r.Tb(1,"app-loader",24),r.Xb()),2&e){var t=r.oc();r.Cb(1),r.tc("loading",t.loading)}}function f(e,n){if(1&e&&(r.Yb(0,"span",32),r.Yb(1,"a",33),r.Tb(2,"app-feather-icons",34),r.Xb(),r.Tb(3,"img",35),r.Tb(4,"br"),r.Xb()),2&e){var t=n.$implicit;r.Cb(1),r.tc("href",t,r.Jc),r.Cb(1),r.tc("icon","download"),r.Cb(1),r.tc("src",t||"assets/images/product-list/001.jpg",r.Jc)}}function m(e,n){if(1&e&&(r.Yb(0,"span",30),r.Pc(1,f,5,3,"span",31),r.Xb()),2&e){var t=r.oc(2).$implicit;r.Cb(1),r.tc("ngForOf",t.images)}}function C(e,n){if(1&e&&(r.Yb(0,"span",28),r.Yb(1,"span"),r.Rc(2),r.Xb(),r.Pc(3,m,2,1,"span",29),r.Xb()),2&e){var t=r.oc().$implicit,i=r.oc();r.Oc("display",i.msgContainerStyle(t)),r.Cb(2),r.Sc(t.text),r.Cb(1),r.tc("ngIf",t.images&&t.images.length)}}var v=function(e,n){return{right:e,left:n}};function M(e,n){if(1&e&&(r.Yb(0,"li",25),r.Yb(1,"div",26),r.Pc(2,C,4,4,"span",27),r.Xb(),r.Xb()),2&e){var t=n.$implicit,i=r.oc();r.tc("ngClass",r.yc(4,v,t.receiverId===i.user.senderId,t.receiverId!==i.user.senderId)),r.Cb(1),r.Oc("text-align",t.receiverId===i.user.senderId?"-webkit-right":"-webkit-left"),r.Cb(1),r.tc("ngIf",t.text||t.images.length)}}function P(e,n){if(1&e){var t=r.Zb();r.Yb(0,"div",36),r.Yb(1,"span",37),r.Yb(2,"app-feather-icons",38),r.kc("click",(function(){return r.Hc(t),r.oc().showDropzone(!1)})),r.Xb(),r.Xb(),r.Yb(3,"div",39),r.Yb(4,"div",40),r.Yb(5,"dropzone",41),r.kc("error",(function(e){return r.Hc(t),r.oc().onUploadError(e)}))("addedFile",(function(e){return r.Hc(t),r.oc().fileAdded(e)}))("removedFile",(function(e){return r.Hc(t),r.oc().removeFile(e)})),r.Xb(),r.Xb(),r.Xb(),r.Xb()}if(2&e){var i=r.oc();r.Cb(2),r.tc("icon","x-circle"),r.Cb(3),r.tc("config",i.config)("message","Click or drag images here to upload")}}var y,_=function(e){return{online:e}},O=((y=function(){function e(){_classCallCheck(this,e),this.scrolltop=240,this.user={},this.loading=!1,this.messages=[],this.onlineUsers=[],this.sendMsg=new r.n,this.msg="",this.files=[],this.enableAttachment=!1,this.isSending=!1,this.config={clickable:!0,maxFiles:4,acceptedFiles:"image/*",maxFilesize:10,autoReset:null,errorReset:null,cancelReset:null,autoProcessQueue:!1,autoQueue:!1,addRemoveLinks:!0,createImageThumbnails:!0}}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"sendMessage",value:function(){var e=this;if(this.msg.trim()||this.files.length){var n={msg:this.msg};this.isSending=!0,this.files.length&&(n.images=this.files.map((function(n){return e.removeBase64(n.dataURL)}))),this.sendMsg.emit(n)}}},{key:"removeBase64",value:function(e){return e.split("base64,")[1]}},{key:"resetState",value:function(){this.msg="",this.enableAttachment=!1,this.files=[]}},{key:"userStatus",value:function(e){return!(!this.onlineUsers.length||!this.onlineUsers.includes(e))}},{key:"showDropzone",value:function(e){this.enableAttachment=e}},{key:"onUploadInit",value:function(e){console.log("dropzone Init",e)}},{key:"onUploadError",value:function(e){console.log("\ud83d\udcbb","on dropzone error",e)}},{key:"onUploadSuccess",value:function(e){console.log("\ud83d\udcbb","on dropzone success",e)}},{key:"fileAdded",value:function(e){console.log("\ud83d\udcbb","on dropzone file added",e),this.files.push(e)}},{key:"removeFile",value:function(e){console.log("\ud83d\udcbb","on dropzone remove",e);var n=this.files.findIndex((function(n){return n.upload.uuid===e.upload.uuid}));this.files.splice(n,1)}},{key:"downloadImage",value:function(e){console.log(e)}},{key:"msgContainerStyle",value:function(e){return!e.text&&e.images&&e.images.length||e.text&&e.images&&e.images.length?"table-cell":e.text&&e.text.length<60?"unset":"inline-block"}},{key:"onScroll",get:function(){var e=this;if(this.scrollMe&&this.scrollMe.nativeElement){var n=this.scrollMe.nativeElement;n.scrollHeight!==this.scrolltop&&setTimeout((function(){e.scrolltop=n.scrollHeight}),500)}return this.scrolltop}}]),e}()).\u0275fac=function(e){return new(e||y)},y.\u0275cmp=r.Mb({type:y,selectors:[["app-chat-box"]],viewQuery:function(e,n){var t;1&e&&r.Xc(h,!0),2&e&&r.Cc(t=r.lc())&&(n.scrollMe=t.first)},inputs:{user:"user",loading:"loading",messages:"messages",onlineUsers:"onlineUsers"},outputs:{sendMsg:"sendMsg"},decls:32,vars:18,consts:[[2,"height","100%","min-height","300px"],[1,"row",2,"height","100%"],[1,"col-sm-12"],[1,"card","chat-container"],[1,"card-header"],[1,"list"],[1,"clearfix"],["alt","",1,"rounded-circle","user-image","blur-up","lazyloaded",3,"src"],[1,"status-circle","offline",3,"ngClass"],[1,"about"],[1,"name"],[1,"status"],[1,"card-body","content",3,"scrollTop"],["scrollMe",""],["style","display: flex; align-items: center; justify-content: center",4,"ngIf"],["class","msg-list",3,"ngClass",4,"ngFor","ngForOf"],[1,"action-footer"],["class","attachment-container",4,"ngIf"],[1,"needs-validation",3,"submit"],[2,"display","grid","grid-template-columns","1fr 9fr 1fr","margin-top","5px"],[1,"icon-btn"],[1,"font-primary",2,"color","#fff !important",3,"icon","click"],["type","text","name","msg",3,"ngModel","placeholder","ngModelChange"],[2,"display","flex","align-items","center","justify-content","center"],[3,"loading"],[1,"msg-list",3,"ngClass"],[1,"msg-container"],["class","msg",3,"display",4,"ngIf"],[1,"msg"],["class","img-list",4,"ngIf"],[1,"img-list"],["class","img-container",4,"ngFor","ngForOf"],[1,"img-container"],["download","","target","_blank",1,"download-icon",2,"position","absolute","right","0",3,"href"],[1,"font-primary",3,"icon"],["alt","chat-image",1,"img-fluid","img-90","rounded","blur-up","lazyloaded",3,"src"],[1,"attachment-container"],[1,"close-btn"],[1,"font-primary",3,"icon","click"],[1,"row"],[1,"col-12"],[3,"config","message","error","addedFile","removedFile"]],template:function(e,n){1&e&&(r.Yb(0,"div",0),r.Yb(1,"div",1),r.Yb(2,"div",2),r.Yb(3,"div",3),r.Yb(4,"div",4),r.Yb(5,"ul",5),r.Yb(6,"li",6),r.Tb(7,"img",7),r.Tb(8,"div",8),r.Yb(9,"div",9),r.Yb(10,"div",10),r.Rc(11),r.Xb(),r.Yb(12,"div",11),r.Rc(13),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Yb(14,"div",12,13),r.Pc(16,p,2,1,"div",14),r.Yb(17,"ul"),r.Pc(18,M,3,7,"li",15),r.Xb(),r.Xb(),r.Yb(19,"div",16),r.Pc(20,P,6,3,"div",17),r.Yb(21,"form",18),r.kc("submit",(function(){return n.sendMessage()})),r.Yb(22,"div",19),r.Yb(23,"div",20),r.Yb(24,"span"),r.Yb(25,"app-feather-icons",21),r.kc("click",(function(){return n.showDropzone(!0)})),r.Xb(),r.Xb(),r.Xb(),r.Yb(26,"div"),r.Yb(27,"input",22),r.kc("ngModelChange",(function(e){return n.msg=e})),r.pc(28,"translate"),r.Xb(),r.Xb(),r.Yb(29,"div",20),r.Yb(30,"span"),r.Yb(31,"app-feather-icons",21),r.kc("click",(function(){return n.sendMessage()})),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb()),2&e&&(r.Cb(7),r.tc("src",n.user.imageUrl?n.user.imageUrl:"assets/images/team/1.jpg",r.Jc),r.Cb(1),r.tc("ngClass",r.xc(16,_,n.userStatus(n.user.senderId))),r.Cb(3),r.Sc(null==n.user?null:n.user.name),r.Cb(2),r.Sc(null==n.user?null:n.user.status),r.Cb(1),r.tc("scrollTop",n.onScroll),r.Cb(2),r.tc("ngIf",n.loading),r.Cb(2),r.tc("ngForOf",n.messages),r.Cb(2),r.tc("ngIf",n.enableAttachment),r.Cb(5),r.tc("icon","paperclip"),r.Cb(2),r.uc("placeholder",r.qc(28,14,"messeges_Typehere")),r.tc("ngModel",n.msg),r.Cb(4),r.Oc("pointer-events",n.isSending?"none":"auto"),r.tc("icon","send"))},directives:[i.k,i.m,i.l,g.y,g.n,g.o,d.a,g.b,g.m,g.p,u.a,s.b],pipes:[b.c],styles:['.chat-container[_ngcontent-%COMP%]{position:relative;height:100%}.chat-container[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:10px 30px;border-bottom:1px solid #c1c1c1}.chat-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{width:100%;max-height:100vh;overflow:auto;padding-bottom:10px}.chat-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:25px}.chat-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   li.right[_ngcontent-%COMP%]{text-align:right}.chat-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   li.right[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]{display:inline-block;background-color:#e1ffc7;color:#000;border-top-right-radius:0;position:relative}.chat-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   li.right[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]:after{top:0;right:-10px;position:absolute;content:"";width:0;height:0;border-color:transparent transparent transparent #e1ffc7;border-style:solid;border-width:0 0 10px 10px}.chat-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]{color:#898989;width:100%;background-color:#ddd;border:1px solid #f8f8f9;padding:10px 15px;border-radius:8px;letter-spacing:1px;position:relative}.chat-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   li.left[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]{border-top-left-radius:0;position:relative}.chat-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   li.left[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]:after{top:0;left:-10px;position:absolute;content:"";width:0;height:0;border-color:transparent #ddd transparent transparent;border-style:solid;border-width:0 10px 10px 0}.chat-container[_ngcontent-%COMP%]   .img-list[_ngcontent-%COMP%]   .img-container[_ngcontent-%COMP%]{display:block;position:relative;margin-bottom:5px;padding:10px}.chat-container[_ngcontent-%COMP%]   .img-list[_ngcontent-%COMP%]   .img-container[_ngcontent-%COMP%]   .download-icon[_ngcontent-%COMP%]{position:absolute;cursor:pointer;right:0;opacity:0;visibility:hidden}.chat-container[_ngcontent-%COMP%]   .img-list[_ngcontent-%COMP%]   .img-container[_ngcontent-%COMP%]:hover   .download-icon[_ngcontent-%COMP%]{visibility:visible;opacity:1;transition:all .4s ease-in-out}.action-footer[_ngcontent-%COMP%]{position:absolute;width:100%;bottom:0;background-color:#c1c1c1;height:45px}.action-footer[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:40px;width:100%;border:none;outline:transparent;padding-left:10px}.action-footer[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]{height:40px;background-color:#c1c1c1}.action-footer[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;cursor:pointer}.card-header[_ngcontent-%COMP%]   .user-image[_ngcontent-%COMP%]{float:left;width:52px;height:52px;margin-right:5px}.card-header[_ngcontent-%COMP%]   .about[_ngcontent-%COMP%]{float:left;margin-top:5px;padding-left:10px}.card-header[_ngcontent-%COMP%]   .friend-list[_ngcontent-%COMP%]{text-align:right}.offline[_ngcontent-%COMP%]{background-color:red}.online[_ngcontent-%COMP%]{background-color:#81ba00}  .attachment-container{background-color:#c1c1c1}  .attachment-container .close-btn{display:block;text-align:right;cursor:pointer}  .attachment-container .dz-progress{display:none!important}  .attachment-container .dz-preview{background-color:#c1c1c1!important}']}),y),x=["chatBox"];function k(e,n){1&e&&(r.Yb(0,"div",8),r.Rc(1," Click on user to start chat "),r.Xb())}function X(e,n){if(1&e){var t=r.Zb();r.Yb(0,"app-chat-box",9,10),r.kc("sendMsg",(function(e){return r.Hc(t),r.oc().sendMessage(e)})),r.Xb()}if(2&e){var i=r.oc();r.tc("user",i.selectedUser)("onlineUsers",i.signalRService.onlineUsers)("loading",i.loadingMessages)("messages",i.signalRService.messages)}}var Y,w,U,S=[{path:"",component:(Y=function(){function e(n){_classCallCheck(this,e),this.signalRService=n,this.selectedUser={},this.allUsers=[],this.messages=[],this.loadingMessages=!1,this.loadingUsers=!1,this.openChatScreen=!1,this.text="",this.receiver_id="",this.userId=""}return _createClass(e,[{key:"ngOnInit",value:function(){this.getSellersList(),this.createConnection()}},{key:"ngOnDestroy",value:function(){this.signalRService.disconnection("ChatHub")}},{key:"createConnection",value:function(){this.signalRService.connect()}},{key:"getSellersList",value:function(){var e=this;this.loadingUsers=!0,this.signalRService.getChatList().subscribe((function(n){console.log("chat list",n),e.loadingUsers=!1,n&&n.body&&n.body.senderList&&(e.allUsers=n.body.senderList)}))}},{key:"openChat",value:function(e){this.openChatScreen=!0,console.log("user",e),this.selectedUser=e,this.getMessages(e.senderId)}},{key:"sendMessage",value:function(e){var n=this,t=e.msg,i=e.images;this.signalRService.sendMessageToApi({text:t,receiverId:this.selectedUser.senderId,images:i}).subscribe((function(e){e&&n.chatBox.resetState()}))}},{key:"getMessages",value:function(e){var n=this;this.loadingMessages=!0,this.signalRService.getChatMessage(e).subscribe((function(e){console.log("get component res get messages",e),n.loadingMessages=!1}))}}]),e}(),Y.\u0275fac=function(e){return new(e||Y)(r.Sb(a.a))},Y.\u0275cmp=r.Mb({type:Y,selectors:[["app-list-message"]],viewQuery:function(e,n){var t;1&e&&r.Xc(x,!0),2&e&&r.Cc(t=r.lc())&&(n.chatBox=t.first)},decls:8,vars:5,consts:[[1,"container-fluid"],[1,"row"],[1,"col-12","col-md-4",2,"margin-bottom","20px"],[1,"right-sidebar","chat-side-bar"],[3,"onlineUsers","allUsers","loading","selectUser"],[1,"col-12","col-md-8",2,"margin-bottom","20px"],["class","no-chat-msg",4,"ngIf"],[3,"user","onlineUsers","loading","messages","sendMsg",4,"ngIf"],[1,"no-chat-msg"],[3,"user","onlineUsers","loading","messages","sendMsg"],["chatBox",""]],template:function(e,n){1&e&&(r.Yb(0,"div",0),r.Yb(1,"div",1),r.Yb(2,"div",2),r.Yb(3,"div",3),r.Yb(4,"app-right-sidebar",4),r.kc("selectUser",(function(e){return n.openChat(e)})),r.Xb(),r.Xb(),r.Xb(),r.Yb(5,"div",5),r.Pc(6,k,2,0,"div",6),r.Pc(7,X,2,4,"app-chat-box",7),r.Xb(),r.Xb(),r.Xb()),2&e&&(r.Cb(4),r.tc("onlineUsers",n.signalRService.onlineUsers)("allUsers",n.allUsers)("loading",n.loadingUsers),r.Cb(2),r.tc("ngIf",!n.openChatScreen),r.Cb(1),r.tc("ngIf",n.openChatScreen))},directives:[l.a,i.m,O],styles:[".chat-side-bar[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;box-shadow:0 0 9px hsla(0,0%,74.9%,.36);right:0!important;top:0!important;position:unset!important}.no-chat-msg[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;color:#c1c1c1;font-size:16px}"]}),Y),data:{title:"All Messages",breadcrumb:"Messages"}}],I=((w=function e(){_classCallCheck(this,e)}).\u0275mod=r.Qb({type:w}),w.\u0275inj=r.Pb({factory:function(e){return new(e||w)},imports:[[c.h.forChild(S)],c.h]}),w),R=t("PCNd"),z={maxFilesize:50,url:"https://httpbin.org/post"},F=((U=function e(){_classCallCheck(this,e)}).\u0275mod=r.Qb({type:U}),U.\u0275inj=r.Pb({factory:function(e){return new(e||U)},providers:[{provide:s.a,useValue:z}],imports:[[i.c,I,o.f,R.a,s.d]]}),U)}}]);